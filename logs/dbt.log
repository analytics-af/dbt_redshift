[0m22:26:58.519909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70cc685ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70cacc9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70cacc99c0>]}


============================== 22:26:58.522574 | e100f027-0f9d-4d5d-a306-b879efcef49e ==============================
[0m22:26:58.522574 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:26:58.523519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/src/app/analytics_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:26:58.524947 [info ] [MainThread]: dbt version: 1.5.2
[0m22:26:58.525708 [info ] [MainThread]: python version: 3.10.12
[0m22:26:58.526495 [info ] [MainThread]: python path: /usr/local/bin/python
[0m22:26:58.527253 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m22:26:58.527986 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m22:26:58.528690 [info ] [MainThread]: Using dbt_project.yml file at /usr/src/app/analytics_dbt/dbt_project.yml
[0m22:26:58.529412 [info ] [MainThread]: Configuration:
[0m22:26:58.630012 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:26:58.656791 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:26:58.657830 [info ] [MainThread]: Required dependencies:
[0m22:26:58.658630 [debug] [MainThread]: Executing "git --help"
[0m22:26:58.660269 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:26:58.661021 [debug] [MainThread]: STDERR: "b''"
[0m22:26:58.661723 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:26:58.662514 [info ] [MainThread]: Connection:
[0m22:26:58.663280 [info ] [MainThread]:   host: redshift-cluster-1.cnjizsmvw1hr.sa-east-1.redshift.amazonaws.com
[0m22:26:58.664188 [info ] [MainThread]:   port: 5439
[0m22:26:58.664912 [info ] [MainThread]:   user: sion
[0m22:26:58.665654 [info ] [MainThread]:   database: dev
[0m22:26:58.666366 [info ] [MainThread]:   schema: public
[0m22:26:58.667153 [info ] [MainThread]:   method: database
[0m22:26:58.667872 [info ] [MainThread]:   cluster_id: None
[0m22:26:58.668598 [info ] [MainThread]:   iam_profile: None
[0m22:26:58.669288 [info ] [MainThread]:   sslmode: prefer
[0m22:26:58.669998 [info ] [MainThread]:   region: None
[0m22:26:58.671390 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m22:26:58.672242 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m22:26:58.673220 [debug] [MainThread]: Using redshift connection "debug"
[0m22:26:58.673862 [debug] [MainThread]: On debug: select 1 as id
[0m22:26:58.674483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:58.676433 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:26:58.677199 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:26:58.979465 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:26:58.980908 [debug] [MainThread]: On debug: Close
[0m22:26:58.981798 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:26:58.982689 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:26:58.983754 [debug] [MainThread]: Command `dbt debug` succeeded at 22:26:58.983656 after 0.49 seconds
[0m22:26:58.984416 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:26:58.985140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70cc685ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70ca788790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70ca789ba0>]}
[0m22:26:58.985866 [debug] [MainThread]: Flushing usage events
[0m23:22:03.203979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0929bbdab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09281c1a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09281c1a20>]}


============================== 23:22:03.207393 | df3df352-8fd0-4024-8154-76fd2fba9860 ==============================
[0m23:22:03.207393 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:22:03.208385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/src/app/dbt_redshift/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:22:03.209590 [info ] [MainThread]: dbt version: 1.5.2
[0m23:22:03.210323 [info ] [MainThread]: python version: 3.10.12
[0m23:22:03.211010 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:22:03.211693 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m23:22:03.212395 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m23:22:03.213126 [info ] [MainThread]: Using dbt_project.yml file at /usr/src/app/dbt_redshift/dbt_project.yml
[0m23:22:03.213776 [info ] [MainThread]: Configuration:
[0m23:22:03.309469 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:22:03.334924 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:22:03.335739 [info ] [MainThread]: Required dependencies:
[0m23:22:03.336488 [debug] [MainThread]: Executing "git --help"
[0m23:22:03.337996 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:22:03.338740 [debug] [MainThread]: STDERR: "b''"
[0m23:22:03.339381 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:22:03.340095 [info ] [MainThread]: Connection:
[0m23:22:03.340849 [info ] [MainThread]:   host: redshift-cluster-1.cnjizsmvw1hr.sa-east-1.redshift.amazonaws.com
[0m23:22:03.341521 [info ] [MainThread]:   port: 5439
[0m23:22:03.342255 [info ] [MainThread]:   user: sion
[0m23:22:03.342928 [info ] [MainThread]:   database: dev
[0m23:22:03.343595 [info ] [MainThread]:   schema: public
[0m23:22:03.344289 [info ] [MainThread]:   method: database
[0m23:22:03.344956 [info ] [MainThread]:   cluster_id: None
[0m23:22:03.345669 [info ] [MainThread]:   iam_profile: None
[0m23:22:03.346412 [info ] [MainThread]:   sslmode: prefer
[0m23:22:03.347077 [info ] [MainThread]:   region: None
[0m23:22:03.348023 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m23:22:03.348885 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m23:22:03.349806 [debug] [MainThread]: Using redshift connection "debug"
[0m23:22:03.350434 [debug] [MainThread]: On debug: select 1 as id
[0m23:22:03.351083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:03.352911 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:22:03.353566 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:22:03.727633 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:03.729066 [debug] [MainThread]: On debug: Close
[0m23:22:03.729891 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:22:03.730763 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:22:03.731686 [debug] [MainThread]: Command `dbt debug` succeeded at 23:22:03.731586 after 0.54 seconds
[0m23:22:03.732302 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:22:03.732959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0929bbdab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0927c84cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0927c84400>]}
[0m23:22:03.733627 [debug] [MainThread]: Flushing usage events
[0m23:22:32.404834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b4cddab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b32c9a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b32c9a20>]}


============================== 23:22:32.407416 | 76889486-397a-41ab-97e2-a546142c76a5 ==============================
[0m23:22:32.407416 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:22:32.408406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/src/app/dbt_redshift/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:22:32.409700 [info ] [MainThread]: dbt version: 1.5.2
[0m23:22:32.410528 [info ] [MainThread]: python version: 3.10.12
[0m23:22:32.411264 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:22:32.411985 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m23:22:32.412703 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m23:22:32.413439 [info ] [MainThread]: Using dbt_project.yml file at /usr/src/app/dbt_redshift/dbt_project.yml
[0m23:22:32.414161 [info ] [MainThread]: Configuration:
[0m23:22:32.519869 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:22:32.548760 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:22:32.549902 [info ] [MainThread]: Required dependencies:
[0m23:22:32.550750 [debug] [MainThread]: Executing "git --help"
[0m23:22:32.552403 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:22:32.553296 [debug] [MainThread]: STDERR: "b''"
[0m23:22:32.554065 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:22:32.554932 [info ] [MainThread]: Connection:
[0m23:22:32.555737 [info ] [MainThread]:   host: redshift-cluster-1.cnjizsmvw1hr.sa-east-1.redshift.amazonaws.com
[0m23:22:32.556486 [info ] [MainThread]:   port: 5439
[0m23:22:32.557237 [info ] [MainThread]:   user: sion
[0m23:22:32.557961 [info ] [MainThread]:   database: dev
[0m23:22:32.558974 [info ] [MainThread]:   schema: public
[0m23:22:32.559761 [info ] [MainThread]:   method: database
[0m23:22:32.560500 [info ] [MainThread]:   cluster_id: None
[0m23:22:32.561214 [info ] [MainThread]:   iam_profile: None
[0m23:22:32.562039 [info ] [MainThread]:   sslmode: prefer
[0m23:22:32.562848 [info ] [MainThread]:   region: None
[0m23:22:32.563867 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m23:22:32.564791 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m23:22:32.566039 [debug] [MainThread]: Using redshift connection "debug"
[0m23:22:32.566784 [debug] [MainThread]: On debug: select 1 as id
[0m23:22:32.567445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:32.569483 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:22:32.570173 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:22:32.789321 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:32.790787 [debug] [MainThread]: On debug: Close
[0m23:22:32.791732 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:22:32.792632 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:22:32.793753 [debug] [MainThread]: Command `dbt debug` succeeded at 23:22:32.793625 after 0.40 seconds
[0m23:22:32.794469 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:22:32.795300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b4cddab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b2d8c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b2d8c910>]}
[0m23:22:32.796189 [debug] [MainThread]: Flushing usage events
[0m14:54:53.439100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa763ce5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7622c5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7622c59c0>]}


============================== 14:54:53.442966 | d7173699-2283-4476-b319-13780689d0b1 ==============================
[0m14:54:53.442966 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:54:53.444194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/src/app/dbt_redshift/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:53.445607 [info ] [MainThread]: dbt version: 1.5.2
[0m14:54:53.446432 [info ] [MainThread]: python version: 3.10.12
[0m14:54:53.447184 [info ] [MainThread]: python path: /usr/local/bin/python
[0m14:54:53.447933 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m14:54:53.448654 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:54:53.449364 [info ] [MainThread]: Using dbt_project.yml file at /usr/src/app/dbt_redshift/dbt_project.yml
[0m14:54:53.450091 [info ] [MainThread]: Configuration:
[0m14:54:53.552917 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:54:53.579338 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:54:53.580365 [info ] [MainThread]: Required dependencies:
[0m14:54:53.581277 [debug] [MainThread]: Executing "git --help"
[0m14:54:53.582860 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:54:53.583958 [debug] [MainThread]: STDERR: "b''"
[0m14:54:53.584601 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:54:53.585415 [info ] [MainThread]: Connection:
[0m14:54:53.586265 [info ] [MainThread]:   host: redshift-cluster-1.cnjizsmvw1hr.sa-east-1.redshift.amazonaws.com
[0m14:54:53.587008 [info ] [MainThread]:   port: 5439
[0m14:54:53.587841 [info ] [MainThread]:   user: sion
[0m14:54:53.588569 [info ] [MainThread]:   database: dev
[0m14:54:53.589250 [info ] [MainThread]:   schema: public
[0m14:54:53.590272 [info ] [MainThread]:   method: database
[0m14:54:53.591035 [info ] [MainThread]:   cluster_id: None
[0m14:54:53.591857 [info ] [MainThread]:   iam_profile: None
[0m14:54:53.592770 [info ] [MainThread]:   sslmode: prefer
[0m14:54:53.593695 [info ] [MainThread]:   region: None
[0m14:54:53.594999 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m14:54:53.595954 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m14:54:53.597168 [debug] [MainThread]: Using redshift connection "debug"
[0m14:54:53.597952 [debug] [MainThread]: On debug: select 1 as id
[0m14:54:53.598632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:53.600628 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:54:53.601319 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:54:53.973336 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:54:53.974761 [debug] [MainThread]: On debug: Close
[0m14:54:53.975588 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:54:53.976446 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:54:53.977583 [debug] [MainThread]: Command `dbt debug` succeeded at 14:54:53.977458 after 0.57 seconds
[0m14:54:53.978303 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:54:53.979180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa763ce5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa761d84700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa761d84610>]}
[0m14:54:53.980075 [debug] [MainThread]: Flushing usage events
[0m14:57:26.236273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7af09ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c794c99f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c794c9990>]}


============================== 14:57:26.238739 | a347bf09-cacd-4bfe-a5a0-5057280af99d ==============================
[0m14:57:26.238739 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:57:26.239645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/src/app/dbt_redshift/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:26.241021 [info ] [MainThread]: dbt version: 1.5.2
[0m14:57:26.241902 [info ] [MainThread]: python version: 3.10.12
[0m14:57:26.243002 [info ] [MainThread]: python path: /usr/local/bin/python
[0m14:57:26.244213 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m14:57:26.244961 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m14:57:26.245709 [info ] [MainThread]: Using dbt_project.yml file at /usr/src/app/dbt_redshift/dbt_project.yml
[0m14:57:26.246440 [info ] [MainThread]: Configuration:
[0m14:57:26.356323 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:57:26.383351 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:57:26.384480 [info ] [MainThread]: Required dependencies:
[0m14:57:26.385499 [debug] [MainThread]: Executing "git --help"
[0m14:57:26.387207 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:57:26.387922 [debug] [MainThread]: STDERR: "b''"
[0m14:57:26.388614 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:57:26.389418 [info ] [MainThread]: Connection:
[0m14:57:26.390216 [info ] [MainThread]:   host: redshift-cluster-1.cnjizsmvw1hr.sa-east-1.redshift.amazonaws.com
[0m14:57:26.390998 [info ] [MainThread]:   port: 5439
[0m14:57:26.391763 [info ] [MainThread]:   user: sion
[0m14:57:26.392553 [info ] [MainThread]:   database: dev
[0m14:57:26.393319 [info ] [MainThread]:   schema: public
[0m14:57:26.394161 [info ] [MainThread]:   method: database
[0m14:57:26.394903 [info ] [MainThread]:   cluster_id: None
[0m14:57:26.395661 [info ] [MainThread]:   iam_profile: None
[0m14:57:26.396393 [info ] [MainThread]:   sslmode: prefer
[0m14:57:26.397149 [info ] [MainThread]:   region: None
[0m14:57:26.398113 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m14:57:26.399921 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m14:57:26.400926 [debug] [MainThread]: Using redshift connection "debug"
[0m14:57:26.401580 [debug] [MainThread]: On debug: select 1 as id
[0m14:57:26.402250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:26.404190 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:57:26.404976 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:57:26.889807 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:57:26.891303 [debug] [MainThread]: On debug: Close
[0m14:57:26.892242 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:57:26.893267 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:57:26.894345 [debug] [MainThread]: Command `dbt debug` succeeded at 14:57:26.894239 after 0.67 seconds
[0m14:57:26.895092 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:57:26.895794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7af09ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c78f8c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c78f8c610>]}
[0m14:57:26.896583 [debug] [MainThread]: Flushing usage events
[0m15:04:09.326671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff091be5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0901d5a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0901d5b10>]}


============================== 15:04:09.329813 | 08c9c602-daa3-4360-801a-0486b972d06a ==============================
[0m15:04:09.329813 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:04:09.330767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:04:09.454880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08c9c602-daa3-4360-801a-0486b972d06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0901d5ae0>]}
[0m15:04:09.470689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08c9c602-daa3-4360-801a-0486b972d06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08fd07940>]}
[0m15:04:09.471590 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:04:09.488460 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:04:09.491122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:04:09.491943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08c9c602-daa3-4360-801a-0486b972d06a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08fd065c0>]}
[0m15:04:10.249302 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:04:10.262794 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:04:10.268256 [debug] [MainThread]: 1603: static parser failed on example/teste.sql
[0m15:04:10.271013 [error] [MainThread]: Encountered an error:
Compilation Error in model teste (models/example/teste.sql)
  expected token ',', got ':'
    line 1
      {{config(materialized:'table')}}
[0m15:04:10.272200 [debug] [MainThread]: Command `dbt run` failed at 15:04:10.272098 after 0.96 seconds
[0m15:04:10.272960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff091be5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f150af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f150b20>]}
[0m15:04:10.273707 [debug] [MainThread]: Flushing usage events
[0m15:05:49.520282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ac06dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52aa6c9a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52aa6c9a20>]}


============================== 15:05:49.522730 | 04f2c070-0e60-4240-8acc-2bc1f4809d32 ==============================
[0m15:05:49.522730 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:05:49.523781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:49.647400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52aa6c9a50>]}
[0m15:05:49.663053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52aa1f5240>]}
[0m15:05:49.663985 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:05:49.680423 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:05:49.683124 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:05:49.683995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52aba824a0>]}
[0m15:05:50.416541 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:05:50.429809 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:05:50.434118 [debug] [MainThread]: 1699: static parser successfully parsed example/teste.sql
[0m15:05:50.520193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a95a3a00>]}
[0m15:05:50.558049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ab39d8d0>]}
[0m15:05:50.559038 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:05:50.559908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ac89ec50>]}
[0m15:05:50.561633 [info ] [MainThread]: 
[0m15:05:50.562880 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:05:50.564512 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:05:50.577301 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:05:50.578157 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:05:50.578839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:50.580812 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:50.581581 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:50.886718 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:50.888535 [debug] [ThreadPool]: On list_dev: Close
[0m15:05:50.890720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:05:50.898617 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:05:50.899311 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:05:50.899975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:50.901073 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:50.901792 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:51.137795 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:51.138809 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:05:51.139563 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:05:51.200548 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:51.202361 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:05:51.256326 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:05:51.269185 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:51.269979 [debug] [MainThread]: On master: BEGIN
[0m15:05:51.270708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:51.271675 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:51.272438 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:51.508532 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:51.509377 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:51.510089 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:51.600265 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:51.601782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ab37fee0>]}
[0m15:05:51.602602 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:51.661092 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:51.661902 [debug] [MainThread]: On master: BEGIN
[0m15:05:51.686616 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:51.687316 [debug] [MainThread]: On master: COMMIT
[0m15:05:51.688077 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:51.688762 [debug] [MainThread]: On master: COMMIT
[0m15:05:51.738423 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:51.739146 [debug] [MainThread]: On master: Close
[0m15:05:51.740386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:05:51.741203 [info ] [MainThread]: 
[0m15:05:51.756887 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m15:05:51.757985 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:05:51.759223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m15:05:51.760007 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m15:05:51.763204 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m15:05:51.780594 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 15:05:51.760622 => 15:05:51.780281
[0m15:05:51.781374 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m15:05:51.828591 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m15:05:51.845931 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:51.846714 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m15:05:51.847525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:51.848557 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:51.849314 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:52.033926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.034954 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.035748 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:05:52.560380 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:05:52.567251 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.568074 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:05:52.643553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.662985 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:05:52.663838 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.664591 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:05:52.777105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.778254 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.778984 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m15:05:52.819397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.825100 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.825889 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:05:52.865490 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.866769 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:05:52.867542 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.868359 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:05:52.893670 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.894500 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:05:52.895218 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m15:05:52.915098 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:52.916406 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 15:05:51.782159 => 15:05:52.916222
[0m15:05:52.917183 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m15:05:52.955787 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m15:05:52.957144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a9966230>]}
[0m15:05:52.958116 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 1.20s]
[0m15:05:52.959141 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m15:05:52.959944 [debug] [Thread-1 (]: Began running node model.analytics_dbt.teste
[0m15:05:52.960822 [info ] [Thread-1 (]: 2 of 3 START sql table model public.teste ...................................... [RUN]
[0m15:05:52.961905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.teste)
[0m15:05:52.962872 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.teste
[0m15:05:52.966169 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.teste"
[0m15:05:52.972475 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.teste (compile): 15:05:52.963513 => 15:05:52.972213
[0m15:05:52.973221 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.teste
[0m15:05:52.980402 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.teste"
[0m15:05:52.987034 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:52.987858 [debug] [Thread-1 (]: On model.analytics_dbt.teste: BEGIN
[0m15:05:52.988547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:52.989490 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:52.990503 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:53.243927 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.244945 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.245700 [debug] [Thread-1 (]: On model.analytics_dbt.teste: create  table
    "dev"."public"."teste__dbt_tmp"
    
    
    
  as (
    

with teste as (
    select 1 as coluna
    union all
    select 2 as coluna
)

select * from teste
  );
[0m15:05:53.463371 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.467360 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.468068 [debug] [Thread-1 (]: On model.analytics_dbt.teste: alter table "dev"."public"."teste__dbt_tmp" rename to "teste"
[0m15:05:53.581719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.584082 [debug] [Thread-1 (]: On model.analytics_dbt.teste: COMMIT
[0m15:05:53.584898 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.585584 [debug] [Thread-1 (]: On model.analytics_dbt.teste: COMMIT
[0m15:05:53.677665 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.678791 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.679560 [debug] [Thread-1 (]: On model.analytics_dbt.teste: BEGIN
[0m15:05:53.735686 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.738748 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.739436 [debug] [Thread-1 (]: On model.analytics_dbt.teste: drop table if exists "dev"."public"."teste__dbt_backup" cascade
[0m15:05:53.795102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.796566 [debug] [Thread-1 (]: On model.analytics_dbt.teste: COMMIT
[0m15:05:53.797401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.798154 [debug] [Thread-1 (]: On model.analytics_dbt.teste: COMMIT
[0m15:05:53.832669 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.833440 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.teste"
[0m15:05:53.834148 [debug] [Thread-1 (]: On model.analytics_dbt.teste: BEGIN
[0m15:05:53.862986 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:53.864250 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.teste (execute): 15:05:52.973776 => 15:05:53.864075
[0m15:05:53.865003 [debug] [Thread-1 (]: On model.analytics_dbt.teste: ROLLBACK
[0m15:05:53.920982 [debug] [Thread-1 (]: On model.analytics_dbt.teste: Close
[0m15:05:53.922386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a8dcab90>]}
[0m15:05:53.923351 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.teste ................................. [[32mSUCCESS[0m in 0.96s]
[0m15:05:53.924321 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.teste
[0m15:05:53.925155 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m15:05:53.926017 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:05:53.927159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.teste, now model.analytics_dbt.my_second_dbt_model)
[0m15:05:53.927987 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m15:05:53.931500 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m15:05:53.938251 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 15:05:53.928709 => 15:05:53.937978
[0m15:05:53.939012 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m15:05:53.960490 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m15:05:53.968462 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:53.969424 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m15:05:53.970102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:53.971055 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:53.971775 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:54.232565 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.233546 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.234284 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m15:05:54.323208 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.327273 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.328080 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:05:54.413092 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.415323 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:05:54.416145 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.416858 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:05:54.501047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.502091 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.502826 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m15:05:54.560415 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.563603 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.564372 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:05:54.620925 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.622369 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:05:54.623171 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.623906 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:05:54.677220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.678188 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:05:54.678979 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m15:05:54.707975 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:54.709302 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 15:05:53.939626 => 15:05:54.709120
[0m15:05:54.710021 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m15:05:54.767680 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m15:05:54.769136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f2c070-0e60-4240-8acc-2bc1f4809d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a99e9cc0>]}
[0m15:05:54.770125 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 0.84s]
[0m15:05:54.771140 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m15:05:54.773095 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:54.773777 [debug] [MainThread]: On master: BEGIN
[0m15:05:54.774604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:54.775872 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:05:54.776590 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:05:55.032935 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:55.033957 [debug] [MainThread]: On master: COMMIT
[0m15:05:55.034764 [debug] [MainThread]: Using redshift connection "master"
[0m15:05:55.035561 [debug] [MainThread]: On master: COMMIT
[0m15:05:55.092883 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:05:55.093793 [debug] [MainThread]: On master: Close
[0m15:05:55.095265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:55.095994 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m15:05:55.096714 [info ] [MainThread]: 
[0m15:05:55.097477 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m15:05:55.098803 [debug] [MainThread]: Command end result
[0m15:05:55.133504 [info ] [MainThread]: 
[0m15:05:55.134514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:55.135335 [info ] [MainThread]: 
[0m15:05:55.136253 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:05:55.137359 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:55.137255 after 5.63 seconds
[0m15:05:55.138133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ac06dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ab39d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a99f8640>]}
[0m15:05:55.138919 [debug] [MainThread]: Flushing usage events
[0m15:27:02.431707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd31ef5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd304d9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd304d9b10>]}


============================== 15:27:02.450393 | 8da9cdb4-f821-4cfd-b462-ff1c0096e988 ==============================
[0m15:27:02.450393 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:27:02.451486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:27:02.576155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8da9cdb4-f821-4cfd-b462-ff1c0096e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd304d9b40>]}
[0m15:27:02.592114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8da9cdb4-f821-4cfd-b462-ff1c0096e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3000b970>]}
[0m15:27:02.593013 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:27:02.612559 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:27:02.631852 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:27:02.633356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8da9cdb4-f821-4cfd-b462-ff1c0096e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2ff98490>]}
[0m15:27:03.369079 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:27:03.382227 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:27:03.386733 [debug] [MainThread]: 1699: static parser successfully parsed example/teste.sql
[0m15:27:03.391013 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales_ptbr.sql
[0m15:27:03.500907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8da9cdb4-f821-4cfd-b462-ff1c0096e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2fa8c850>]}
[0m15:27:03.512397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8da9cdb4-f821-4cfd-b462-ff1c0096e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2fa8f7f0>]}
[0m15:27:03.513301 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:27:03.514086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8da9cdb4-f821-4cfd-b462-ff1c0096e988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2fa8c7f0>]}
[0m15:27:03.515725 [warn ] [MainThread]: The selection criterion 'views/vw_sales_ptbr.sql' does not match any nodes
[0m15:27:03.517112 [info ] [MainThread]: 
[0m15:27:03.517899 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:27:03.518916 [debug] [MainThread]: Command end result
[0m15:27:03.530284 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:03.530117 after 1.12 seconds
[0m15:27:03.531109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd31ef5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd31bc71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2ff9b7c0>]}
[0m15:27:03.531852 [debug] [MainThread]: Flushing usage events
[0m15:28:17.235172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0c9e1ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0afddab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0afddb40>]}


============================== 15:28:17.237806 | d54d0057-e624-45b0-bf57-ec5b50e21587 ==============================
[0m15:28:17.237806 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:28:17.238775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:28:17.361509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0afddb10>]}
[0m15:28:17.378051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0ab079a0>]}
[0m15:28:17.379166 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:28:17.398965 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:28:17.518118 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:28:17.519031 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://models/example/teste.sql
[0m15:28:17.531727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09f857b0>]}
[0m15:28:17.542769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0a39db70>]}
[0m15:28:17.543591 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:28:17.544462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0a39db40>]}
[0m15:28:17.546267 [info ] [MainThread]: 
[0m15:28:17.547381 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:28:17.549011 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:28:17.560931 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:28:17.561855 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:28:17.562673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:17.564627 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:17.565357 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:17.831554 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:17.833434 [debug] [ThreadPool]: On list_dev: Close
[0m15:28:17.835632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:28:17.843533 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:28:17.844342 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:28:17.845188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:17.846111 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:17.846830 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:18.077113 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.078080 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:28:18.078808 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:28:18.138724 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.140567 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:28:18.194228 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:28:18.208470 [debug] [MainThread]: Using redshift connection "master"
[0m15:28:18.209280 [debug] [MainThread]: On master: BEGIN
[0m15:28:18.210011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:18.211001 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:18.211671 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:18.389517 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.390441 [debug] [MainThread]: Using redshift connection "master"
[0m15:28:18.391207 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:18.465320 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.467114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09bbcac0>]}
[0m15:28:18.467913 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:18.513733 [debug] [MainThread]: Using redshift connection "master"
[0m15:28:18.514480 [debug] [MainThread]: On master: BEGIN
[0m15:28:18.532850 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.533632 [debug] [MainThread]: On master: COMMIT
[0m15:28:18.534446 [debug] [MainThread]: Using redshift connection "master"
[0m15:28:18.535146 [debug] [MainThread]: On master: COMMIT
[0m15:28:18.570917 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.571657 [debug] [MainThread]: On master: Close
[0m15:28:18.572838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:18.573600 [info ] [MainThread]: 
[0m15:28:18.576891 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m15:28:18.577899 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:28:18.579182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m15:28:18.580133 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m15:28:18.583381 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m15:28:18.589910 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 15:28:18.580848 => 15:28:18.589660
[0m15:28:18.590683 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m15:28:18.640422 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m15:28:18.647984 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:18.648821 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m15:28:18.649633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:18.650564 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:18.651280 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:18.880443 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.881293 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:18.882060 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:28:18.975806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:18.982717 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:18.983590 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:28:19.081350 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.085039 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:19.085815 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:28:19.159207 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.180707 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:28:19.181588 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:19.182309 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:28:19.270886 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.271906 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:19.272640 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m15:28:19.322389 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.328947 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:19.329886 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:28:19.382745 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.384097 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:28:19.384924 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:19.385629 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m15:28:19.438773 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.439613 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m15:28:19.440392 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m15:28:19.466136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.467392 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 15:28:18.591465 => 15:28:19.467214
[0m15:28:19.468135 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m15:28:19.518122 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m15:28:19.519573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09fb8a60>]}
[0m15:28:19.520611 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 0.94s]
[0m15:28:19.521711 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m15:28:19.522600 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales_ptbr
[0m15:28:19.523503 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales_ptbr ............................... [RUN]
[0m15:28:19.524879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales_ptbr)
[0m15:28:19.525627 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales_ptbr
[0m15:28:19.528118 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:19.539986 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (compile): 15:28:19.526264 => 15:28:19.539675
[0m15:28:19.540753 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales_ptbr
[0m15:28:19.559856 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:19.570671 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:19.571407 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:28:19.572135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:19.573113 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:19.573886 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:19.798153 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.799067 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:19.799817 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: create view "dev"."public"."vw_sales_ptbr__dbt_tmp" as (
    with sales_dbt as (
    select *
    from
    sales
)

SELECT
    salesid AS id_venda,
    listid AS id_lista,
    sellerid AS id_vendedor,
    buyerid AS id_comprador,
    eventid AS id_evento,
    dateid AS id_data,
    qtysold AS quantidade_vendida,
    pricepaid AS preco_pago,
    commission AS comissao,
    saletime AS horario_da_venda
FROM sales_dbt
  ) ;
[0m15:28:19.877808 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.881588 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:19.882327 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr__dbt_tmp" rename to "vw_sales_ptbr"
[0m15:28:19.954246 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:19.956493 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:28:19.957332 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:19.958052 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:28:20.032841 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.034084 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:20.034859 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:28:20.084164 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.087213 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:20.087897 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: drop view if exists "dev"."public"."vw_sales_ptbr__dbt_backup" cascade
[0m15:28:20.136836 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.138082 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:28:20.138922 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:20.139638 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:28:20.189317 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.190083 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:28:20.190811 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:28:20.215197 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.216408 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (execute): 15:28:19.541332 => 15:28:20.216230
[0m15:28:20.217110 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: ROLLBACK
[0m15:28:20.265994 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: Close
[0m15:28:20.267203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09fb8ee0>]}
[0m15:28:20.268116 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales_ptbr .......................... [[32mSUCCESS[0m in 0.74s]
[0m15:28:20.269054 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales_ptbr
[0m15:28:20.269849 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m15:28:20.270653 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m15:28:20.271746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales_ptbr, now model.analytics_dbt.my_second_dbt_model)
[0m15:28:20.272580 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m15:28:20.275883 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.282403 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 15:28:20.273364 => 15:28:20.282150
[0m15:28:20.283186 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m15:28:20.288096 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.294938 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.296004 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m15:28:20.296762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:20.297791 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:20.298503 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:20.557026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.557882 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.558650 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m15:28:20.646050 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.651743 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.652544 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:28:20.736148 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.738187 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:28:20.738997 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.739826 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:28:20.823115 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.824049 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.824782 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m15:28:20.882598 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.885762 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.886478 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:28:20.943202 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:20.944524 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:28:20.945335 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:20.946067 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m15:28:20.999097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:21.000025 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m15:28:21.000812 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m15:28:21.029673 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:21.031062 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 15:28:20.283841 => 15:28:21.030887
[0m15:28:21.031793 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m15:28:21.088954 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m15:28:21.090523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54d0057-e624-45b0-bf57-ec5b50e21587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09bc6110>]}
[0m15:28:21.091496 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 0.82s]
[0m15:28:21.092499 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m15:28:21.094506 [debug] [MainThread]: Using redshift connection "master"
[0m15:28:21.095221 [debug] [MainThread]: On master: BEGIN
[0m15:28:21.095946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:21.096925 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:28:21.097719 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:28:21.317056 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:21.317995 [debug] [MainThread]: On master: COMMIT
[0m15:28:21.318798 [debug] [MainThread]: Using redshift connection "master"
[0m15:28:21.319452 [debug] [MainThread]: On master: COMMIT
[0m15:28:21.367576 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:28:21.368268 [debug] [MainThread]: On master: Close
[0m15:28:21.369490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:21.370176 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m15:28:21.370877 [info ] [MainThread]: 
[0m15:28:21.371658 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m15:28:21.373246 [debug] [MainThread]: Command end result
[0m15:28:21.384869 [info ] [MainThread]: 
[0m15:28:21.385959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:21.386931 [info ] [MainThread]: 
[0m15:28:21.387917 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:28:21.389158 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:21.389020 after 4.17 seconds
[0m15:28:21.389970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0c9e1ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09bc6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0aa9ec50>]}
[0m15:28:21.390883 [debug] [MainThread]: Flushing usage events
[0m15:35:57.903452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8b3b1ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac899d9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac899d9b70>]}


============================== 15:35:57.907645 | 1695f65e-888c-432b-b691-8e4cdd262b5e ==============================
[0m15:35:57.907645 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:35:57.908646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:35:58.029673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1695f65e-888c-432b-b691-8e4cdd262b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac899d9ba0>]}
[0m15:35:58.045566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1695f65e-888c-432b-b691-8e4cdd262b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac89509210>]}
[0m15:35:58.046515 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:35:58.066862 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:35:58.205372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:35:58.206398 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/views/vw_categoria_ptbr.sql
[0m15:35:58.230327 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_categoria_ptbr.sql
[0m15:35:58.253019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1695f65e-888c-432b-b691-8e4cdd262b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac885d4d30>]}
[0m15:35:58.264512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1695f65e-888c-432b-b691-8e4cdd262b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac88533e20>]}
[0m15:35:58.265323 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:35:58.266132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1695f65e-888c-432b-b691-8e4cdd262b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac88533f10>]}
[0m15:35:58.267766 [warn ] [MainThread]: The selection criterion 'views/vw_categoria_ptbr.sql' does not match any nodes
[0m15:35:58.269029 [info ] [MainThread]: 
[0m15:35:58.269804 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:35:58.270812 [debug] [MainThread]: Command end result
[0m15:35:58.281863 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:58.281671 after 0.39 seconds
[0m15:35:58.282671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8b3b1ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8949ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac88533af0>]}
[0m15:35:58.283770 [debug] [MainThread]: Flushing usage events
[0m15:36:13.830192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff447581ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff445bc9ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff445bc9b40>]}


============================== 15:36:13.832664 | 4b63e873-dc0b-4470-b29b-02d20b726d13 ==============================
[0m15:36:13.832664 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:36:13.833647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/src/app/dbt_redshift/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:36:13.953381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff445bc9b70>]}
[0m15:36:13.969451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4456f75e0>]}
[0m15:36:13.970525 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:36:13.991954 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:36:14.113287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:14.114168 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:14.120300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff444759b10>]}
[0m15:36:14.131721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff444725cc0>]}
[0m15:36:14.132541 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:36:14.133377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff444725c90>]}
[0m15:36:14.135206 [info ] [MainThread]: 
[0m15:36:14.136494 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:36:14.138330 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:36:14.150734 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:36:14.151968 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:36:14.152710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:14.154660 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:36:14.155338 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:36:14.406354 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:14.408193 [debug] [ThreadPool]: On list_dev: Close
[0m15:36:14.410446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:36:14.418543 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:36:14.419321 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:36:14.420050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:14.421003 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:36:14.421658 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:36:14.607236 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:14.608196 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:36:14.608886 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:36:14.656504 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:14.658299 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:36:14.700418 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:36:14.713882 [debug] [MainThread]: Using redshift connection "master"
[0m15:36:14.714728 [debug] [MainThread]: On master: BEGIN
[0m15:36:14.715483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:14.716370 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:36:14.717040 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:36:14.911304 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:14.912194 [debug] [MainThread]: Using redshift connection "master"
[0m15:36:14.912960 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:36:14.990646 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:14.992732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44478da80>]}
[0m15:36:14.993542 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:15.044329 [debug] [MainThread]: Using redshift connection "master"
[0m15:36:15.045129 [debug] [MainThread]: On master: BEGIN
[0m15:36:15.065788 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.066470 [debug] [MainThread]: On master: COMMIT
[0m15:36:15.067254 [debug] [MainThread]: Using redshift connection "master"
[0m15:36:15.068095 [debug] [MainThread]: On master: COMMIT
[0m15:36:15.108372 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.109115 [debug] [MainThread]: On master: Close
[0m15:36:15.110428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:15.111235 [info ] [MainThread]: 
[0m15:36:15.114502 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_categoria_ptbr
[0m15:36:15.115400 [info ] [Thread-1 (]: 1 of 2 START sql view model public.vw_categoria_ptbr ........................... [RUN]
[0m15:36:15.116727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.vw_categoria_ptbr)
[0m15:36:15.117458 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_categoria_ptbr
[0m15:36:15.122210 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:36:15.129096 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (compile): 15:36:15.118041 => 15:36:15.128775
[0m15:36:15.129853 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_categoria_ptbr
[0m15:36:15.167826 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:36:15.175317 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:36:15.176029 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:36:15.176729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:15.177774 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:36:15.178481 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:36:15.358857 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.359743 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:36:15.360474 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: create view "dev"."public"."vw_categoria_ptbr__dbt_tmp" as (
    with category_dbt as (
    select * from category
)

RENAME (
    SELECT
    catid AS id_categoria,
    catgroup AS grupo_categoria,
    catname AS nome_categoria,
    catdesc AS descricao_categoria
    FROM category_dbt
)

SELECT * FROM RENAME
WHERE catid >= 5 AND catgroup LIKE 'Conc%'
  ) ;
[0m15:36:15.381084 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "RENAME"
[0m15:36:15.381779 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: ROLLBACK
[0m15:36:15.419424 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (execute): 15:36:15.130680 => 15:36:15.419226
[0m15:36:15.420126 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: Close
[0m15:36:15.423206 [debug] [Thread-1 (]: Database Error in model vw_categoria_ptbr (models/views/vw_categoria_ptbr.sql)
  syntax error at or near "RENAME"
  compiled Code at target/run/analytics_dbt/models/views/vw_categoria_ptbr.sql
[0m15:36:15.423971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff445712e60>]}
[0m15:36:15.424912 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.vw_categoria_ptbr .................. [[31mERROR[0m in 0.31s]
[0m15:36:15.425761 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_categoria_ptbr
[0m15:36:15.426527 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales_ptbr
[0m15:36:15.427332 [info ] [Thread-1 (]: 2 of 2 START sql view model public.vw_sales_ptbr ............................... [RUN]
[0m15:36:15.428428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_categoria_ptbr, now model.analytics_dbt.vw_sales_ptbr)
[0m15:36:15.429208 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales_ptbr
[0m15:36:15.432222 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.437936 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (compile): 15:36:15.429791 => 15:36:15.437694
[0m15:36:15.438696 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales_ptbr
[0m15:36:15.443487 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.449965 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.450846 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:36:15.451525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:15.452434 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:36:15.453112 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:36:15.627945 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.628822 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.629525 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: create view "dev"."public"."vw_sales_ptbr__dbt_tmp" as (
    with sales_dbt as (
    select *
    from
    sales
)

SELECT
    salesid AS id_venda,
    listid AS id_lista,
    sellerid AS id_vendedor,
    buyerid AS id_comprador,
    eventid AS id_evento,
    dateid AS id_data,
    qtysold AS quantidade_vendida,
    pricepaid AS preco_pago,
    commission AS comissao,
    saletime AS horario_da_venda
FROM sales_dbt
  ) ;
[0m15:36:15.687812 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.694501 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.695202 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr" rename to "vw_sales_ptbr__dbt_backup"
[0m15:36:15.747993 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.751165 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.751847 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr__dbt_tmp" rename to "vw_sales_ptbr"
[0m15:36:15.804944 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.822961 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:36:15.823771 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.824499 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:36:15.888872 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.889784 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.890493 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:36:15.926844 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.932858 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.933619 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: drop view if exists "dev"."public"."vw_sales_ptbr__dbt_backup" cascade
[0m15:36:15.972102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:15.973276 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:36:15.974003 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:15.974764 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:36:16.019190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:16.020175 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:36:16.020891 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:36:16.039687 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:16.040946 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (execute): 15:36:15.439344 => 15:36:16.040770
[0m15:36:16.041657 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: ROLLBACK
[0m15:36:16.077286 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: Close
[0m15:36:16.078446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b63e873-dc0b-4470-b29b-02d20b726d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44474aad0>]}
[0m15:36:16.079370 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.vw_sales_ptbr .......................... [[32mSUCCESS[0m in 0.65s]
[0m15:36:16.080363 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales_ptbr
[0m15:36:16.082210 [debug] [MainThread]: Using redshift connection "master"
[0m15:36:16.082895 [debug] [MainThread]: On master: BEGIN
[0m15:36:16.083563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:16.084488 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:36:16.085181 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:36:16.259822 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:16.260805 [debug] [MainThread]: On master: COMMIT
[0m15:36:16.261586 [debug] [MainThread]: Using redshift connection "master"
[0m15:36:16.262254 [debug] [MainThread]: On master: COMMIT
[0m15:36:16.299337 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:36:16.300181 [debug] [MainThread]: On master: Close
[0m15:36:16.301394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:16.302079 [debug] [MainThread]: Connection 'model.analytics_dbt.vw_sales_ptbr' was properly closed.
[0m15:36:16.302792 [info ] [MainThread]: 
[0m15:36:16.303579 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m15:36:16.304940 [debug] [MainThread]: Command end result
[0m15:36:16.316818 [info ] [MainThread]: 
[0m15:36:16.317985 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:36:16.318832 [info ] [MainThread]: 
[0m15:36:16.319686 [error] [MainThread]: [33mDatabase Error in model vw_categoria_ptbr (models/views/vw_categoria_ptbr.sql)[0m
[0m15:36:16.320592 [error] [MainThread]:   syntax error at or near "RENAME"
[0m15:36:16.321491 [error] [MainThread]:   compiled Code at target/run/analytics_dbt/models/views/vw_categoria_ptbr.sql
[0m15:36:16.322335 [info ] [MainThread]: 
[0m15:36:16.323163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:36:16.324181 [debug] [MainThread]: Command `dbt run` failed at 15:36:16.324048 after 2.51 seconds
[0m15:36:16.325084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff447581ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44474aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4443bc1f0>]}
[0m15:36:16.325824 [debug] [MainThread]: Flushing usage events
[0m15:36:58.334401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b39f9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b1fddb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b1fddb10>]}


============================== 15:36:58.336804 | 856a3007-1677-4c8c-8706-5cc34f48e24a ==============================
[0m15:36:58.336804 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:36:58.337805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:36:58.458607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '856a3007-1677-4c8c-8706-5cc34f48e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b1fddb40>]}
[0m15:36:58.474395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '856a3007-1677-4c8c-8706-5cc34f48e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b1b0ba00>]}
[0m15:36:58.475488 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:36:58.496588 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:36:58.625705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:58.626796 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_categoria_ptbr.sql
[0m15:36:58.650299 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_categoria_ptbr.sql
[0m15:36:58.672280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '856a3007-1677-4c8c-8706-5cc34f48e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b0fd4f70>]}
[0m15:36:58.683626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '856a3007-1677-4c8c-8706-5cc34f48e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b0f41ba0>]}
[0m15:36:58.684438 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:36:58.685251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856a3007-1677-4c8c-8706-5cc34f48e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b0f41c90>]}
[0m15:36:58.686764 [warn ] [MainThread]: The selection criterion 'views/vw_categoria_ptbr.sql' does not match any nodes
[0m15:36:58.688089 [info ] [MainThread]: 
[0m15:36:58.688824 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:36:58.689811 [debug] [MainThread]: Command end result
[0m15:36:58.700956 [debug] [MainThread]: Command `dbt run` succeeded at 15:36:58.700782 after 0.38 seconds
[0m15:36:58.701773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b39f9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b0f84730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70b0f84d00>]}
[0m15:36:58.702584 [debug] [MainThread]: Flushing usage events
[0m15:37:02.686556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65394f9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6537ad5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6537ad5ae0>]}


============================== 15:37:02.689041 | 6b7233c9-dfac-41f2-8dc8-b74afdf9a03e ==============================
[0m15:37:02.689041 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:37:02.689974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:37:02.811628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6537ad5b10>]}
[0m15:37:02.827240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65376079a0>]}
[0m15:37:02.828341 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:37:02.847710 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:37:02.971525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:02.972339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:02.978625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6536d71ab0>]}
[0m15:37:02.990173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6536d3dbd0>]}
[0m15:37:02.991020 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:37:02.991909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6536d3db70>]}
[0m15:37:02.993526 [info ] [MainThread]: 
[0m15:37:02.994761 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:37:02.996336 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:37:03.009017 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:37:03.010015 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:37:03.010694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:03.012578 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:03.013249 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:03.288599 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:03.290456 [debug] [ThreadPool]: On list_dev: Close
[0m15:37:03.292654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:37:03.300670 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:37:03.301376 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:37:03.302064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:03.302931 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:03.303598 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:03.481895 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:03.482840 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:37:03.483584 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:37:03.529653 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:03.531600 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:37:03.572080 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:37:03.585205 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:03.585917 [debug] [MainThread]: On master: BEGIN
[0m15:37:03.586592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:03.587431 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:03.588059 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:03.816083 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:03.817046 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:03.817812 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:03.904997 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:03.907114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6536da5a80>]}
[0m15:37:03.907949 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:03.966475 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:03.967208 [debug] [MainThread]: On master: BEGIN
[0m15:37:03.992279 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:03.992954 [debug] [MainThread]: On master: COMMIT
[0m15:37:03.993711 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:03.994439 [debug] [MainThread]: On master: COMMIT
[0m15:37:04.043274 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.044153 [debug] [MainThread]: On master: Close
[0m15:37:04.045430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:04.046269 [info ] [MainThread]: 
[0m15:37:04.049479 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:04.050662 [info ] [Thread-1 (]: 1 of 2 START sql view model public.vw_categoria_ptbr ........................... [RUN]
[0m15:37:04.051822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.vw_categoria_ptbr)
[0m15:37:04.052563 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:04.057254 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:04.063578 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (compile): 15:37:04.053236 => 15:37:04.063329
[0m15:37:04.064450 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:04.099476 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:04.106588 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:04.107347 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:37:04.108125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:04.109210 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:04.109981 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:04.311547 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.312507 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:04.313265 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: create view "dev"."public"."vw_categoria_ptbr__dbt_tmp" as (
    with category_dbt as (
    select * from category
)

RENAME as (
    SELECT
    catid AS id_categoria,
    catgroup AS grupo_categoria,
    catname AS nome_categoria,
    catdesc AS descricao_categoria
    FROM category_dbt
)

SELECT * FROM RENAME
WHERE catid >= 5 AND catgroup LIKE 'Conc%'
  ) ;
[0m15:37:04.336559 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "RENAME"
[0m15:37:04.337414 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: ROLLBACK
[0m15:37:04.380388 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (execute): 15:37:04.065104 => 15:37:04.380193
[0m15:37:04.381104 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: Close
[0m15:37:04.383156 [debug] [Thread-1 (]: Database Error in model vw_categoria_ptbr (models/views/vw_categoria_ptbr.sql)
  syntax error at or near "RENAME"
  compiled Code at target/run/analytics_dbt/models/views/vw_categoria_ptbr.sql
[0m15:37:04.383935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538fecdf0>]}
[0m15:37:04.384898 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.vw_categoria_ptbr .................. [[31mERROR[0m in 0.33s]
[0m15:37:04.385781 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:04.386699 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales_ptbr
[0m15:37:04.387568 [info ] [Thread-1 (]: 2 of 2 START sql view model public.vw_sales_ptbr ............................... [RUN]
[0m15:37:04.388730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_categoria_ptbr, now model.analytics_dbt.vw_sales_ptbr)
[0m15:37:04.389482 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales_ptbr
[0m15:37:04.392486 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.399167 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (compile): 15:37:04.390100 => 15:37:04.398923
[0m15:37:04.399955 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales_ptbr
[0m15:37:04.404758 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.411845 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.412650 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:37:04.413414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:04.414367 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:04.415086 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:04.636998 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.637981 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.638730 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: create view "dev"."public"."vw_sales_ptbr__dbt_tmp" as (
    with sales_dbt as (
    select *
    from
    sales
)

SELECT
    salesid AS id_venda,
    listid AS id_lista,
    sellerid AS id_vendedor,
    buyerid AS id_comprador,
    eventid AS id_evento,
    dateid AS id_data,
    qtysold AS quantidade_vendida,
    pricepaid AS preco_pago,
    commission AS comissao,
    saletime AS horario_da_venda
FROM sales_dbt
  ) ;
[0m15:37:04.716224 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.723122 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.723923 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr" rename to "vw_sales_ptbr__dbt_backup"
[0m15:37:04.796969 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.800783 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.801533 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr__dbt_tmp" rename to "vw_sales_ptbr"
[0m15:37:04.873892 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.892456 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:04.893311 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.894043 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:04.970369 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:04.971339 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:04.972061 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:37:05.020387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:05.026415 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:05.027185 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: drop view if exists "dev"."public"."vw_sales_ptbr__dbt_backup" cascade
[0m15:37:05.078007 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:05.079451 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:05.080233 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:05.080931 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:05.130663 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:05.131557 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:05.132322 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:37:05.157127 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:05.158403 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (execute): 15:37:04.400603 => 15:37:05.158204
[0m15:37:05.159138 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: ROLLBACK
[0m15:37:05.207326 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: Close
[0m15:37:05.208763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7233c9-dfac-41f2-8dc8-b74afdf9a03e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6536139720>]}
[0m15:37:05.209751 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.vw_sales_ptbr .......................... [[32mSUCCESS[0m in 0.82s]
[0m15:37:05.210768 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales_ptbr
[0m15:37:05.212662 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:05.213360 [debug] [MainThread]: On master: BEGIN
[0m15:37:05.214038 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:05.215087 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:05.215757 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:05.393719 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:05.394585 [debug] [MainThread]: On master: COMMIT
[0m15:37:05.395367 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:05.396043 [debug] [MainThread]: On master: COMMIT
[0m15:37:05.433759 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:05.434460 [debug] [MainThread]: On master: Close
[0m15:37:05.435669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:05.436360 [debug] [MainThread]: Connection 'model.analytics_dbt.vw_sales_ptbr' was properly closed.
[0m15:37:05.437054 [info ] [MainThread]: 
[0m15:37:05.437816 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m15:37:05.438965 [debug] [MainThread]: Command end result
[0m15:37:05.450146 [info ] [MainThread]: 
[0m15:37:05.451157 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:05.451959 [info ] [MainThread]: 
[0m15:37:05.452706 [error] [MainThread]: [33mDatabase Error in model vw_categoria_ptbr (models/views/vw_categoria_ptbr.sql)[0m
[0m15:37:05.453610 [error] [MainThread]:   syntax error at or near "RENAME"
[0m15:37:05.454470 [error] [MainThread]:   compiled Code at target/run/analytics_dbt/models/views/vw_categoria_ptbr.sql
[0m15:37:05.455234 [info ] [MainThread]: 
[0m15:37:05.456006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:37:05.457009 [debug] [MainThread]: Command `dbt run` failed at 15:37:05.456903 after 2.78 seconds
[0m15:37:05.457793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65394f9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6538fecdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65369e0280>]}
[0m15:37:05.458505 [debug] [MainThread]: Flushing usage events
[0m15:37:36.034287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763b42dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76399d9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76399d9b70>]}


============================== 15:37:36.036747 | ac9f144e-5671-41a1-9797-907bba2fab63 ==============================
[0m15:37:36.036747 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:37:36.037720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/src/app/dbt_redshift/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:37:36.157135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac9f144e-5671-41a1-9797-907bba2fab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76399d9ba0>]}
[0m15:37:36.172675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac9f144e-5671-41a1-9797-907bba2fab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639509210>]}
[0m15:37:36.173580 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:37:36.193710 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:37:36.325548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:36.326591 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_categoria_ptbr.sql
[0m15:37:36.350472 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_categoria_ptbr.sql
[0m15:37:36.372867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac9f144e-5671-41a1-9797-907bba2fab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76389d8fd0>]}
[0m15:37:36.383927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac9f144e-5671-41a1-9797-907bba2fab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7638d2dcf0>]}
[0m15:37:36.384773 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:37:36.385616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac9f144e-5671-41a1-9797-907bba2fab63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7638d2dcc0>]}
[0m15:37:36.387189 [warn ] [MainThread]: The selection criterion 'views/vw_categoria_ptbr.sql' does not match any nodes
[0m15:37:36.388446 [info ] [MainThread]: 
[0m15:37:36.389273 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:37:36.390184 [debug] [MainThread]: Command end result
[0m15:37:36.400939 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:36.400771 after 0.38 seconds
[0m15:37:36.401867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763b42dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763949ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76389844f0>]}
[0m15:37:36.402690 [debug] [MainThread]: Flushing usage events
[0m15:37:39.950259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9c4a9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9aac1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9aac1b70>]}


============================== 15:37:39.952818 | 9b0d100e-5be7-4e24-8f30-47b257e3ea40 ==============================
[0m15:37:39.952818 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:37:39.953764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:37:40.075127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9aac1ba0>]}
[0m15:37:40.090614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9a5f1210>]}
[0m15:37:40.091574 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:37:40.111476 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:37:40.235323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:40.236126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:40.242486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a99955b40>]}
[0m15:37:40.253973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a99921cf0>]}
[0m15:37:40.254896 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:37:40.255732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a99921cc0>]}
[0m15:37:40.257398 [info ] [MainThread]: 
[0m15:37:40.258685 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:37:40.260435 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:37:40.272859 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:37:40.274096 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:37:40.274890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:40.276833 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:40.277601 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:40.585942 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:40.587677 [debug] [ThreadPool]: On list_dev: Close
[0m15:37:40.589874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:37:40.598162 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:37:40.598874 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:37:40.599527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:40.600422 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:40.601090 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:40.827407 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:40.828330 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:37:40.829061 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:37:40.887210 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:40.888930 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:37:40.942939 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:37:40.956030 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:40.956782 [debug] [MainThread]: On master: BEGIN
[0m15:37:40.957438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:40.958331 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:40.958987 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:41.141757 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:41.142667 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:41.143394 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:41.226313 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:41.228542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a99989ab0>]}
[0m15:37:41.229385 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:41.287705 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:41.305016 [debug] [MainThread]: On master: BEGIN
[0m15:37:41.323938 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:41.324744 [debug] [MainThread]: On master: COMMIT
[0m15:37:41.325499 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:41.326161 [debug] [MainThread]: On master: COMMIT
[0m15:37:41.362242 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:41.363075 [debug] [MainThread]: On master: Close
[0m15:37:41.364335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:41.365146 [info ] [MainThread]: 
[0m15:37:41.368112 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:41.369119 [info ] [Thread-1 (]: 1 of 2 START sql view model public.vw_categoria_ptbr ........................... [RUN]
[0m15:37:41.370359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.vw_categoria_ptbr)
[0m15:37:41.371136 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:41.375877 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:41.382528 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (compile): 15:37:41.371745 => 15:37:41.382245
[0m15:37:41.383302 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:41.418532 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:41.425392 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:41.426308 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:37:41.426975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:41.428035 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:41.428724 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:41.644532 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:41.645366 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:37:41.646087 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: create view "dev"."public"."vw_categoria_ptbr__dbt_tmp" as (
    with category_dbt as (
    select * from category
),

RENAME as (
    SELECT
    catid AS id_categoria,
    catgroup AS grupo_categoria,
    catname AS nome_categoria,
    catdesc AS descricao_categoria
    FROM category_dbt
)

SELECT * FROM RENAME
WHERE catid >= 5 AND catgroup LIKE 'Conc%'
  ) ;
[0m15:37:41.671828 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "catid" does not exist in rename
[0m15:37:41.672621 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: ROLLBACK
[0m15:37:41.718998 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (execute): 15:37:41.383903 => 15:37:41.718794
[0m15:37:41.719716 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: Close
[0m15:37:41.721830 [debug] [Thread-1 (]: Database Error in model vw_categoria_ptbr (models/views/vw_categoria_ptbr.sql)
  column "catid" does not exist in rename
  compiled Code at target/run/analytics_dbt/models/views/vw_categoria_ptbr.sql
[0m15:37:41.722577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a995b5c90>]}
[0m15:37:41.723452 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.vw_categoria_ptbr .................. [[31mERROR[0m in 0.35s]
[0m15:37:41.724321 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_categoria_ptbr
[0m15:37:41.725265 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales_ptbr
[0m15:37:41.726073 [info ] [Thread-1 (]: 2 of 2 START sql view model public.vw_sales_ptbr ............................... [RUN]
[0m15:37:41.727168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_categoria_ptbr, now model.analytics_dbt.vw_sales_ptbr)
[0m15:37:41.727873 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales_ptbr
[0m15:37:41.730931 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:41.736834 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (compile): 15:37:41.728591 => 15:37:41.736571
[0m15:37:41.737596 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales_ptbr
[0m15:37:41.742336 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:41.749111 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:41.749920 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:37:41.750651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:41.751574 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:41.752276 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:42.232321 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.233356 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.234115 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: create view "dev"."public"."vw_sales_ptbr__dbt_tmp" as (
    with sales_dbt as (
    select *
    from
    sales
)

SELECT
    salesid AS id_venda,
    listid AS id_lista,
    sellerid AS id_vendedor,
    buyerid AS id_comprador,
    eventid AS id_evento,
    dateid AS id_data,
    qtysold AS quantidade_vendida,
    pricepaid AS preco_pago,
    commission AS comissao,
    saletime AS horario_da_venda
FROM sales_dbt
  ) ;
[0m15:37:42.319340 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.326098 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.326814 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr" rename to "vw_sales_ptbr__dbt_backup"
[0m15:37:42.401143 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.404511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.405215 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr__dbt_tmp" rename to "vw_sales_ptbr"
[0m15:37:42.479172 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.496965 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:42.497782 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.498473 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:42.623942 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.625618 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.626625 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:37:42.680217 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.690117 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.690926 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: drop view if exists "dev"."public"."vw_sales_ptbr__dbt_backup" cascade
[0m15:37:42.744382 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.746179 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:42.747073 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.747811 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:37:42.799086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.800205 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:37:42.800930 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:37:42.827129 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:42.828796 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (execute): 15:37:41.738175 => 15:37:42.828606
[0m15:37:42.829556 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: ROLLBACK
[0m15:37:42.880277 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: Close
[0m15:37:42.881895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b0d100e-5be7-4e24-8f30-47b257e3ea40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a98d1d720>]}
[0m15:37:42.882854 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.vw_sales_ptbr .......................... [[32mSUCCESS[0m in 1.15s]
[0m15:37:42.883872 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales_ptbr
[0m15:37:42.886100 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:42.886850 [debug] [MainThread]: On master: BEGIN
[0m15:37:42.887542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:42.888457 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:37:42.889144 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:37:43.138431 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:43.139607 [debug] [MainThread]: On master: COMMIT
[0m15:37:43.140558 [debug] [MainThread]: Using redshift connection "master"
[0m15:37:43.141444 [debug] [MainThread]: On master: COMMIT
[0m15:37:43.195112 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:37:43.196252 [debug] [MainThread]: On master: Close
[0m15:37:43.198183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:43.199064 [debug] [MainThread]: Connection 'model.analytics_dbt.vw_sales_ptbr' was properly closed.
[0m15:37:43.199898 [info ] [MainThread]: 
[0m15:37:43.200778 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m15:37:43.202797 [debug] [MainThread]: Command end result
[0m15:37:43.219859 [info ] [MainThread]: 
[0m15:37:43.221178 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:43.222344 [info ] [MainThread]: 
[0m15:37:43.223352 [error] [MainThread]: [33mDatabase Error in model vw_categoria_ptbr (models/views/vw_categoria_ptbr.sql)[0m
[0m15:37:43.224414 [error] [MainThread]:   column "catid" does not exist in rename
[0m15:37:43.225434 [error] [MainThread]:   compiled Code at target/run/analytics_dbt/models/views/vw_categoria_ptbr.sql
[0m15:37:43.226474 [info ] [MainThread]: 
[0m15:37:43.227511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:37:43.228913 [debug] [MainThread]: Command `dbt run` failed at 15:37:43.228743 after 3.29 seconds
[0m15:37:43.230063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9c4a9ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a98d1ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a98d14fa0>]}
[0m15:37:43.230890 [debug] [MainThread]: Flushing usage events
[0m15:38:06.569617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ab569ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9ac9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9ac9b70>]}


============================== 15:38:06.572059 | f71bfe33-cb9e-4056-8d53-1f12c88e2e76 ==============================
[0m15:38:06.572059 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:38:06.573015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:38:06.691042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f71bfe33-cb9e-4056-8d53-1f12c88e2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9ac9ba0>]}
[0m15:38:06.707172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f71bfe33-cb9e-4056-8d53-1f12c88e2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a95f9210>]}
[0m15:38:06.708277 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:38:06.728918 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:38:06.864738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:06.865647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:06.871811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f71bfe33-cb9e-4056-8d53-1f12c88e2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8761b40>]}
[0m15:38:06.883817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f71bfe33-cb9e-4056-8d53-1f12c88e2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a872dcf0>]}
[0m15:38:06.884968 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:38:06.885821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f71bfe33-cb9e-4056-8d53-1f12c88e2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a872dcc0>]}
[0m15:38:06.887523 [info ] [MainThread]: 
[0m15:38:06.888685 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:38:06.890267 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:38:06.902460 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:38:06.903442 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:38:06.904165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:06.906393 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:06.907174 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:07.177410 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.179254 [debug] [ThreadPool]: On list_dev: Close
[0m15:38:07.181461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:38:07.189878 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:38:07.190633 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:38:07.191340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:07.192206 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:07.192933 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:07.371026 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.372066 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:38:07.372787 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:38:07.419593 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.421330 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:38:07.461277 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:38:07.474556 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:07.475315 [debug] [MainThread]: On master: BEGIN
[0m15:38:07.475984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:07.476840 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:07.477486 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:07.700897 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.701936 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:07.702682 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:38:07.789601 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.791842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f71bfe33-cb9e-4056-8d53-1f12c88e2e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8795a50>]}
[0m15:38:07.792644 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:07.855634 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:07.856538 [debug] [MainThread]: On master: BEGIN
[0m15:38:07.880777 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.881538 [debug] [MainThread]: On master: COMMIT
[0m15:38:07.882278 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:07.882907 [debug] [MainThread]: On master: COMMIT
[0m15:38:07.930708 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:07.931642 [debug] [MainThread]: On master: Close
[0m15:38:13.011693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:13.012614 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m15:38:13.013339 [info ] [MainThread]: 
[0m15:38:13.014110 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m15:38:13.015164 [error] [MainThread]: Encountered an error:

[0m15:38:13.017726 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 565, in run
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 443, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 342, in execute_nodes
    fire_event(
  File "/usr/local/lib/python3.10/site-packages/dbt/events/functions.py", line 261, in fire_event
    EVENT_MANAGER.fire_event(e, level=level)
  File "/usr/local/lib/python3.10/site-packages/dbt/events/eventmgr.py", line 202, in fire_event
    logger.write_line(msg)
  File "/usr/local/lib/python3.10/site-packages/dbt/events/eventmgr.py", line 122, in write_line
    send_to_logger(self._python_logger, msg.info.level, line)
  File "/usr/local/lib/python3.10/site-packages/dbt/events/eventmgr.py", line 62, in send_to_logger
    l.info(log_line)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1477, in info
    self._log(INFO, msg, args, **kwargs)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1624, in _log
    self.handle(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1634, in handle
    self.callHandlers(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1696, in callHandlers
    hdlr.handle(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 968, in handle
    self.emit(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1103, in emit
    stream.write(msg + self.terminator)
KeyboardInterrupt

[0m15:38:13.018890 [debug] [MainThread]: Command `dbt run` failed at 15:38:13.018748 after 6.46 seconds
[0m15:38:13.019865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ab569ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a872c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a872d4b0>]}
[0m15:38:13.020733 [debug] [MainThread]: Flushing usage events
[0m15:38:17.089195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c806dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c65d9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c65d9b10>]}


============================== 15:38:17.091747 | ad733d4c-f343-49d8-a6e4-aae465c5244a ==============================
[0m15:38:17.091747 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:38:17.092892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:38:17.217981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c65d9b40>]}
[0m15:38:17.234437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c610ba00>]}
[0m15:38:17.235416 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:38:17.256265 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:38:17.387716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:17.388730 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_categoria_ptbr.sql
[0m15:38:17.412780 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_categoria_ptbr.sql
[0m15:38:17.435778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c55d4f70>]}
[0m15:38:17.447695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c553dc90>]}
[0m15:38:17.448688 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:38:17.449545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c553dc60>]}
[0m15:38:17.451078 [info ] [MainThread]: 
[0m15:38:17.452233 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:38:17.453594 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:38:17.466516 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:38:17.467548 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:38:17.468386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:17.470598 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:17.471365 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:17.705556 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:17.707448 [debug] [ThreadPool]: On list_dev: Close
[0m15:38:17.709650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:38:17.718178 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:38:17.718943 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:38:17.719600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:17.720489 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:17.721165 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:17.948673 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:17.949508 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:38:17.950198 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:38:18.007723 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.009657 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:38:18.061330 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:38:18.075188 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:18.076004 [debug] [MainThread]: On master: BEGIN
[0m15:38:18.076714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:18.077644 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:18.078324 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:18.306365 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.307311 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:18.308071 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:38:18.394635 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.396811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c510b130>]}
[0m15:38:18.397641 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:18.459227 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:18.460275 [debug] [MainThread]: On master: BEGIN
[0m15:38:18.484971 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.485884 [debug] [MainThread]: On master: COMMIT
[0m15:38:18.486721 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:18.487445 [debug] [MainThread]: On master: COMMIT
[0m15:38:18.535692 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.536425 [debug] [MainThread]: On master: Close
[0m15:38:18.537722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:18.538523 [info ] [MainThread]: 
[0m15:38:18.541763 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_categoria_ptbr
[0m15:38:18.542776 [info ] [Thread-1 (]: 1 of 2 START sql view model public.vw_categoria_ptbr ........................... [RUN]
[0m15:38:18.544163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.vw_categoria_ptbr)
[0m15:38:18.544907 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_categoria_ptbr
[0m15:38:18.547251 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:18.553737 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (compile): 15:38:18.545505 => 15:38:18.553444
[0m15:38:18.554653 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_categoria_ptbr
[0m15:38:18.595984 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:18.647467 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:18.648270 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:38:18.648985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:18.650094 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:18.650816 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:18.829020 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.830147 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:18.831104 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: create view "dev"."public"."vw_categoria_ptbr__dbt_tmp" as (
    with category_dbt as (
    select * from category
),

RENAME as (
    SELECT
    catid AS id_categoria,
    catgroup AS grupo_categoria,
    catname AS nome_categoria,
    catdesc AS descricao_categoria
    FROM category_dbt
)

SELECT * FROM RENAME
WHERE id_categoria >= 5 AND grupo_categoria LIKE 'Conc%'
  ) ;
[0m15:38:18.891874 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.899486 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:18.900524 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: alter table "dev"."public"."vw_categoria_ptbr__dbt_tmp" rename to "vw_categoria_ptbr"
[0m15:38:18.956200 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:18.973419 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:38:18.974384 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:18.975337 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:38:19.039332 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.040528 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:19.041290 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:38:19.078764 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.084259 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:19.085079 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: drop view if exists "dev"."public"."vw_categoria_ptbr__dbt_backup" cascade
[0m15:38:19.121488 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.122908 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:38:19.123722 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:19.124502 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:38:19.167370 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.168161 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:38:19.168938 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:38:19.187971 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.189324 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (execute): 15:38:18.555407 => 15:38:19.189146
[0m15:38:19.190116 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: ROLLBACK
[0m15:38:19.226991 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: Close
[0m15:38:19.228313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c553db70>]}
[0m15:38:19.229282 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.vw_categoria_ptbr ...................... [[32mSUCCESS[0m in 0.68s]
[0m15:38:19.230232 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_categoria_ptbr
[0m15:38:19.231119 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales_ptbr
[0m15:38:19.232146 [info ] [Thread-1 (]: 2 of 2 START sql view model public.vw_sales_ptbr ............................... [RUN]
[0m15:38:19.233216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_categoria_ptbr, now model.analytics_dbt.vw_sales_ptbr)
[0m15:38:19.233959 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales_ptbr
[0m15:38:19.236222 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.242012 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (compile): 15:38:19.234589 => 15:38:19.241744
[0m15:38:19.242722 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales_ptbr
[0m15:38:19.247526 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.254379 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.255107 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:38:19.255787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:19.256702 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:19.257385 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:19.437574 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.438508 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.439223 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: create view "dev"."public"."vw_sales_ptbr__dbt_tmp" as (
    with sales_dbt as (
    select *
    from
    sales
)

SELECT
    salesid AS id_venda,
    listid AS id_lista,
    sellerid AS id_vendedor,
    buyerid AS id_comprador,
    eventid AS id_evento,
    dateid AS id_data,
    qtysold AS quantidade_vendida,
    pricepaid AS preco_pago,
    commission AS comissao,
    saletime AS horario_da_venda
FROM sales_dbt
  ) ;
[0m15:38:19.499470 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.503262 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.504029 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr" rename to "vw_sales_ptbr__dbt_backup"
[0m15:38:19.560818 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.564247 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.564952 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: alter table "dev"."public"."vw_sales_ptbr__dbt_tmp" rename to "vw_sales_ptbr"
[0m15:38:19.618214 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.624350 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:38:19.625203 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.625881 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:38:19.689658 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.690870 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.691598 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:38:19.728530 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.731592 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.732294 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: drop view if exists "dev"."public"."vw_sales_ptbr__dbt_backup" cascade
[0m15:38:19.770682 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.771877 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:38:19.772582 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.773249 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: COMMIT
[0m15:38:19.823697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.824511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales_ptbr"
[0m15:38:19.825190 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: BEGIN
[0m15:38:19.843694 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:19.844945 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales_ptbr (execute): 15:38:19.243292 => 15:38:19.844755
[0m15:38:19.845654 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: ROLLBACK
[0m15:38:19.882198 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales_ptbr: Close
[0m15:38:19.883433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad733d4c-f343-49d8-a6e4-aae465c5244a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c4978670>]}
[0m15:38:19.884353 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.vw_sales_ptbr .......................... [[32mSUCCESS[0m in 0.65s]
[0m15:38:19.885334 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales_ptbr
[0m15:38:19.887261 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:19.887918 [debug] [MainThread]: On master: BEGIN
[0m15:38:19.888581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:19.889475 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:38:19.890114 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:38:20.058544 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:20.059452 [debug] [MainThread]: On master: COMMIT
[0m15:38:20.060213 [debug] [MainThread]: Using redshift connection "master"
[0m15:38:20.060840 [debug] [MainThread]: On master: COMMIT
[0m15:38:20.097296 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:38:20.097976 [debug] [MainThread]: On master: Close
[0m15:38:20.099097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:20.099765 [debug] [MainThread]: Connection 'model.analytics_dbt.vw_sales_ptbr' was properly closed.
[0m15:38:20.100434 [info ] [MainThread]: 
[0m15:38:20.101175 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m15:38:20.102574 [debug] [MainThread]: Command end result
[0m15:38:20.114118 [info ] [MainThread]: 
[0m15:38:20.115152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:20.116047 [info ] [MainThread]: 
[0m15:38:20.116884 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:38:20.118065 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:20.117950 after 3.04 seconds
[0m15:38:20.118815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c806dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c610ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c4d43cd0>]}
[0m15:38:20.119670 [debug] [MainThread]: Flushing usage events
[0m15:39:56.248090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2120b5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2106d5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2106d5ba0>]}


============================== 15:39:56.250599 | 987d8f94-43bd-4b31-b321-4bde9d4dbe01 ==============================
[0m15:39:56.250599 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:39:56.251587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/src/app/dbt_redshift/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:39:56.380187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2106d5b70>]}
[0m15:39:56.397923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb210207a00>]}
[0m15:39:56.399120 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:39:56.420087 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:39:56.551617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:56.552427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:56.558603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20f56dae0>]}
[0m15:39:56.569861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20f53dba0>]}
[0m15:39:56.570635 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:39:56.571439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20f53dc90>]}
[0m15:39:56.575864 [info ] [MainThread]: 
[0m15:39:56.577055 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:39:56.578595 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:39:56.590830 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:39:56.591778 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:39:56.592498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:56.594641 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:56.595432 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:56.932877 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:56.934666 [debug] [ThreadPool]: On list_dev: Close
[0m15:39:56.936772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:39:56.944834 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:39:56.945528 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:39:56.946249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:56.947170 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:56.947843 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:57.124796 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:57.125794 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:39:57.126516 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:39:57.171009 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:57.172956 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:39:57.214162 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:39:57.227801 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.228582 [debug] [MainThread]: On master: BEGIN
[0m15:39:57.229229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:57.230104 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:57.230768 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:57.495445 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:57.496266 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.497001 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:57.594294 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:57.596512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20f5a5a80>]}
[0m15:39:57.597292 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:57.665611 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.666368 [debug] [MainThread]: On master: BEGIN
[0m15:39:57.696801 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:57.697526 [debug] [MainThread]: On master: COMMIT
[0m15:39:57.698282 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:57.698967 [debug] [MainThread]: On master: COMMIT
[0m15:39:57.756616 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:57.757389 [debug] [MainThread]: On master: Close
[0m15:39:57.758634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:57.759446 [info ] [MainThread]: 
[0m15:39:57.762699 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_categoria_ptbr
[0m15:39:57.763557 [info ] [Thread-1 (]: 1 of 1 START sql view model public.vw_categoria_ptbr ........................... [RUN]
[0m15:39:57.764644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.vw_categoria_ptbr)
[0m15:39:57.765391 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_categoria_ptbr
[0m15:39:57.770650 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:57.777388 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (compile): 15:39:57.766012 => 15:39:57.777133
[0m15:39:57.778141 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_categoria_ptbr
[0m15:39:57.816421 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:57.823748 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:57.824495 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:39:57.825194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:57.826257 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:57.827011 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:58.072093 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.073071 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.073847 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: create view "dev"."public"."vw_categoria_ptbr__dbt_tmp" as (
    with category_dbt as (
    select * from category
),

RENAME as (
    SELECT
    catid AS id_categoria,
    catgroup AS grupo_categoria,
    catname AS nome_categoria,
    catdesc AS descricao_categoria
    FROM category_dbt
)

SELECT * FROM RENAME
WHERE id_categoria >= 5 AND grupo_categoria LIKE 'Conc%'
  ) ;
[0m15:39:58.159985 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.166904 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.167724 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: alter table "dev"."public"."vw_categoria_ptbr" rename to "vw_categoria_ptbr__dbt_backup"
[0m15:39:58.249438 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.252927 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.253693 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: alter table "dev"."public"."vw_categoria_ptbr__dbt_tmp" rename to "vw_categoria_ptbr"
[0m15:39:58.335062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.353182 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:39:58.354290 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.355023 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:39:58.434514 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.435564 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.436342 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:39:58.490390 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.496072 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.496835 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: drop view if exists "dev"."public"."vw_categoria_ptbr__dbt_backup" cascade
[0m15:39:58.555640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.557189 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:39:58.558037 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.558755 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: COMMIT
[0m15:39:58.611140 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.612144 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_categoria_ptbr"
[0m15:39:58.612905 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: BEGIN
[0m15:39:58.641800 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.643186 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_categoria_ptbr (execute): 15:39:57.778750 => 15:39:58.643003
[0m15:39:58.643944 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: ROLLBACK
[0m15:39:58.698942 [debug] [Thread-1 (]: On model.analytics_dbt.vw_categoria_ptbr: Close
[0m15:39:58.700278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987d8f94-43bd-4b31-b321-4bde9d4dbe01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20f598fd0>]}
[0m15:39:58.701253 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.vw_categoria_ptbr ...................... [[32mSUCCESS[0m in 0.94s]
[0m15:39:58.702235 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_categoria_ptbr
[0m15:39:58.704436 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:58.705169 [debug] [MainThread]: On master: BEGIN
[0m15:39:58.705900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:58.706820 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:39:58.707520 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:39:58.961103 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:58.962120 [debug] [MainThread]: On master: COMMIT
[0m15:39:58.962941 [debug] [MainThread]: Using redshift connection "master"
[0m15:39:58.963613 [debug] [MainThread]: On master: COMMIT
[0m15:39:59.019037 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:39:59.019759 [debug] [MainThread]: On master: Close
[0m15:39:59.021031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:59.021677 [debug] [MainThread]: Connection 'model.analytics_dbt.vw_categoria_ptbr' was properly closed.
[0m15:39:59.022355 [info ] [MainThread]: 
[0m15:39:59.023095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m15:39:59.024294 [debug] [MainThread]: Command end result
[0m15:39:59.036843 [info ] [MainThread]: 
[0m15:39:59.038042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:59.038938 [info ] [MainThread]: 
[0m15:39:59.039884 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:59.041022 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:59.040914 after 2.80 seconds
[0m15:39:59.041722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2120b5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20edc3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20edc3940>]}
[0m15:39:59.042444 [debug] [MainThread]: Flushing usage events
[0m15:47:41.973157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d34869ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32ec1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32ec1b10>]}


============================== 15:47:41.975774 | 25d0d2f9-76e9-48ab-9301-e0cda5bb0888 ==============================
[0m15:47:41.975774 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:47:41.976827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/app/dbt_redshift/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:47:42.101212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25d0d2f9-76e9-48ab-9301-e0cda5bb0888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32ec1b40>]}
[0m15:47:42.117143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25d0d2f9-76e9-48ab-9301-e0cda5bb0888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d329efa00>]}
[0m15:47:42.118139 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:47:42.140673 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:47:42.155285 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:47:42.156671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25d0d2f9-76e9-48ab-9301-e0cda5bb0888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32981660>]}
[0m15:47:42.906870 [debug] [MainThread]: 1699: static parser successfully parsed DW/fato_vendas.sql
[0m15:47:42.919831 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:47:42.924455 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:47:42.928665 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_categoria_ptbr.sql
[0m15:47:42.932665 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales_ptbr.sql
[0m15:47:42.989561 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.analytics_dbt.fato_vendas' (models/DW/fato_vendas.sql) depends on a node named 'vw_sales_ptbr.sql' which was not found
[0m15:47:42.990775 [debug] [MainThread]: Command `dbt run` failed at 15:47:42.990664 after 1.03 seconds
[0m15:47:42.991570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d34869ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d31de3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d31de3220>]}
[0m15:47:42.992353 [debug] [MainThread]: Flushing usage events
[0m15:49:10.856824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe6279ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe48bdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe48bdba0>]}


============================== 15:49:10.859227 | f06b9748-4c63-48a2-a08b-ff6ddeb76074 ==============================
[0m15:49:10.859227 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:49:10.860406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/src/app/dbt_redshift/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:49:10.981555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe48bdb70>]}
[0m15:49:10.997366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe43efa00>]}
[0m15:49:10.998361 [info ] [MainThread]: Registered adapter: redshift=1.5.6
[0m15:49:11.018393 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:49:11.030169 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:49:11.031105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe4382fb0>]}
[0m15:49:11.748841 [debug] [MainThread]: 1699: static parser successfully parsed DW/fato_vendas.sql
[0m15:49:11.761994 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m15:49:11.766421 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m15:49:11.770477 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_categoria_ptbr.sql
[0m15:49:11.774492 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales_ptbr.sql
[0m15:49:11.886328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe3b285b0>]}
[0m15:49:11.896599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe3b29db0>]}
[0m15:49:11.897396 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:49:11.898172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe3b28e50>]}
[0m15:49:11.902481 [info ] [MainThread]: 
[0m15:49:11.903714 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:49:11.905231 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m15:49:11.917785 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m15:49:11.918689 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m15:49:11.919394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:11.921500 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:49:11.922238 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:49:12.358715 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:12.360479 [debug] [ThreadPool]: On list_dev: Close
[0m15:49:12.362757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m15:49:12.371595 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:49:12.372502 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m15:49:12.373219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:12.374135 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:49:12.374819 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:49:12.642195 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:12.643144 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m15:49:12.643859 [debug] [ThreadPool]: On list_dev_public: select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
[0m15:49:12.711410 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:12.713411 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m15:49:12.775432 [debug] [ThreadPool]: On list_dev_public: Close
[0m15:49:12.788924 [debug] [MainThread]: Using redshift connection "master"
[0m15:49:12.789621 [debug] [MainThread]: On master: BEGIN
[0m15:49:12.790277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:12.791116 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:49:12.791759 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:49:12.968190 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:12.969179 [debug] [MainThread]: Using redshift connection "master"
[0m15:49:12.969957 [debug] [MainThread]: On master: with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:13.045319 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:13.047454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe37c5d20>]}
[0m15:49:13.048307 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:13.093415 [debug] [MainThread]: Using redshift connection "master"
[0m15:49:13.094209 [debug] [MainThread]: On master: BEGIN
[0m15:49:13.112575 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:13.113309 [debug] [MainThread]: On master: COMMIT
[0m15:49:13.114081 [debug] [MainThread]: Using redshift connection "master"
[0m15:49:13.114775 [debug] [MainThread]: On master: COMMIT
[0m15:49:13.151674 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:13.152384 [debug] [MainThread]: On master: Close
[0m15:49:13.153596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:13.154425 [info ] [MainThread]: 
[0m15:49:13.157602 [debug] [Thread-1 (]: Began running node model.analytics_dbt.fato_vendas
[0m15:49:13.158577 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fato_vendas ................................ [RUN]
[0m15:49:13.159809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.fato_vendas)
[0m15:49:13.160679 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.fato_vendas
[0m15:49:13.164059 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.fato_vendas"
[0m15:49:13.174813 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.fato_vendas (compile): 15:49:13.161344 => 15:49:13.174471
[0m15:49:13.175718 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.fato_vendas
[0m15:49:13.225614 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.fato_vendas"
[0m15:49:13.236343 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:13.237104 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: BEGIN
[0m15:49:13.237832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:13.238804 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:49:13.239568 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:49:13.489346 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:13.490317 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:13.491074 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: create  table
    "dev"."public"."fato_vendas__dbt_tmp"
    
    
    
  as (
    SELECT * FROM "dev"."public"."vw_sales_ptbr"
  );
[0m15:49:18.631150 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m15:49:18.638319 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:18.639153 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: alter table "dev"."public"."fato_vendas__dbt_tmp" rename to "fato_vendas"
[0m15:49:18.747421 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:18.766939 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: COMMIT
[0m15:49:18.767851 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:18.768656 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: COMMIT
[0m15:49:18.884644 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:18.885620 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:18.886342 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: BEGIN
[0m15:49:18.942214 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:18.947896 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:18.948651 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: drop table if exists "dev"."public"."fato_vendas__dbt_backup" cascade
[0m15:49:19.004141 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:19.005425 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: COMMIT
[0m15:49:19.006178 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:19.006849 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: COMMIT
[0m15:49:19.040644 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:19.041511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.fato_vendas"
[0m15:49:19.042165 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: BEGIN
[0m15:49:19.069988 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:19.071225 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.fato_vendas (execute): 15:49:13.176415 => 15:49:19.071045
[0m15:49:19.071955 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: ROLLBACK
[0m15:49:19.128335 [debug] [Thread-1 (]: On model.analytics_dbt.fato_vendas: Close
[0m15:49:19.129613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f06b9748-4c63-48a2-a08b-ff6ddeb76074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe440b280>]}
[0m15:49:19.130519 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fato_vendas ........................... [[32mSUCCESS[0m in 5.97s]
[0m15:49:19.131478 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.fato_vendas
[0m15:49:19.133272 [debug] [MainThread]: Using redshift connection "master"
[0m15:49:19.134016 [debug] [MainThread]: On master: BEGIN
[0m15:49:19.134686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:19.135620 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:49:19.136301 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:49:19.317999 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:19.318996 [debug] [MainThread]: On master: COMMIT
[0m15:49:19.319796 [debug] [MainThread]: Using redshift connection "master"
[0m15:49:19.320487 [debug] [MainThread]: On master: COMMIT
[0m15:49:19.356825 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:19.357558 [debug] [MainThread]: On master: Close
[0m15:49:19.358790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:19.359500 [debug] [MainThread]: Connection 'model.analytics_dbt.fato_vendas' was properly closed.
[0m15:49:19.360213 [info ] [MainThread]: 
[0m15:49:19.361010 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m15:49:19.362233 [debug] [MainThread]: Command end result
[0m15:49:19.373670 [info ] [MainThread]: 
[0m15:49:19.374691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:19.375541 [info ] [MainThread]: 
[0m15:49:19.376444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:19.377720 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:19.377583 after 8.53 seconds
[0m15:49:19.378774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe6279ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe440b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe5ddfd00>]}
[0m15:49:19.379734 [debug] [MainThread]: Flushing usage events
